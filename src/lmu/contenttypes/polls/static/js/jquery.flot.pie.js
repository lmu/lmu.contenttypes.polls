(function(s){var c={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,offset:{top:0,left:"auto"},stroke:{color:"#FFF",width:1},label:{show:"auto",formatter:function(c,s){return'<div style="font-size:x-small;text-align:center;padding:2px;color:'+s.color+';">'+c+"<br/>"+Math.round(s.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:0.5}}}};s.plot.plugins.push({init:function(r){function F(a){A||
(A=!0,l=a.getCanvas(),t=s(l).parent(),c=a.getOptions(),a.setData(G(a.getData())))}function G(a){for(var b=0;b<a.length;++b)if("number"==typeof a[b].data)a[b].data=[[1,a[b].data]];else if("undefined"==typeof a[b].data||"undefined"==typeof a[b].data[0])"undefined"!=typeof a[b].data&&"undefined"!=typeof a[b].data.label&&(a[b].label=a[b].data.label),a[b].data=[[1,0]];for(var b=a,j=0;j<b.length;++j){var g=parseFloat(b[j].data[0][1]);g&&(n+=g)}for(var j=b=0,g=c.series.pie.combine.color,f=[],d=0;d<a.length;++d)a[d].data[0][1]=
parseFloat(a[d].data[0][1]),a[d].data[0][1]||(a[d].data[0][1]=0),a[d].data[0][1]/n<=c.series.pie.combine.threshold?(b+=a[d].data[0][1],j++,g||(g=a[d].color)):f.push({data:[[1,a[d].data[0][1]]],color:a[d].color,label:a[d].label,angle:a[d].data[0][1]*2*Math.PI/n,percent:100*(a[d].data[0][1]/n)});0<j&&f.push({data:[[1,b]],color:g,label:c.series.pie.combine.label,angle:b*2*Math.PI/n,percent:100*(b/n)});return f}function H(a,b){function j(){ctx.clearRect(0,0,l.width,l.height);t.children().filter(".pieLabel, .pieLabelBackground").remove()}
function g(){var a=1<c.series.pie.radius?c.series.pie.radius:o*c.series.pie.radius;if(!(a>=l.width/2-5||a*c.series.pie.tilt>=l.height/2-15||10>=a)){ctx.save();ctx.translate(5,15);ctx.globalAlpha=0.02;ctx.fillStyle="#000";ctx.translate(m,v);ctx.scale(1,c.series.pie.tilt);for(var b=1;10>=b;b++)ctx.beginPath(),ctx.arc(0,0,a,0,2*Math.PI,!1),ctx.fill(),a-=b;ctx.restore()}}function f(){function a(b,c,d){0>=b||isNaN(b)||(d?ctx.fillStyle=c:(ctx.strokeStyle=c,ctx.lineJoin="round"),ctx.beginPath(),1.0E-9<Math.abs(b-
2*Math.PI)?ctx.moveTo(0,0):s.browser.msie&&(b-=1.0E-4),ctx.arc(0,0,f,g,g+b,!1),ctx.closePath(),g+=b,d?ctx.fill():ctx.stroke())}function b(){for(var a=j,f=1<c.series.pie.label.radius?c.series.pie.label.radius:o*c.series.pie.label.radius,g=0;g<d.length;++g){if(d[g].percent>=100*c.series.pie.label.threshold){var e=d[g],h=a,q=g;if(0!=e.data[0][1]){var p=c.legend.labelFormatter,k=void 0,r=c.series.pie.label.formatter,k=p?p(e.label,e):e.label;r&&(k=r(k,e));p=(h+e.angle+h)/2;h=m+Math.round(Math.cos(p)*f);
p=v+Math.round(Math.sin(p)*f)*c.series.pie.tilt;t.append('<span class="pieLabel" id="pieLabel'+q+'" style="position:absolute;top:'+p+"px;left:"+h+'px;">'+k+"</span>");q=t.children("#pieLabel"+q);k=p-q.height()/2;p=h-q.width()/2;q.css("top",k);q.css("left",p);if(0<0-k||0<0-p||0>l.height-(k+q.height())||0>l.width-(p+q.width()))w=!0;0!=c.series.pie.label.background.opacity&&(h=c.series.pie.label.background.color,null==h&&(h=e.color),e="top:"+k+"px;left:"+p+"px;",s('<div class="pieLabelBackground" style="position:absolute;width:'+
q.width()+"px;height:"+q.height()+"px;"+e+"background-color:"+h+';"> </div>').insertBefore(q).css("opacity",c.series.pie.label.background.opacity))}}a+=d[g].angle}}var j=Math.PI*c.series.pie.startAngle,f;f=1<c.series.pie.radius?c.series.pie.radius:o*c.series.pie.radius;ctx.save();ctx.translate(m,v);ctx.scale(1,c.series.pie.tilt);ctx.save();for(var g=j,h=0;h<d.length;++h)d[h].startAngle=g,a(d[h].angle,d[h].color,!0);ctx.restore();if(0<c.series.pie.stroke.width){ctx.save();ctx.lineWidth=c.series.pie.stroke.width;
g=j;for(h=0;h<d.length;++h)a(d[h].angle,c.series.pie.stroke.color,!1);ctx.restore()}B(ctx);c.series.pie.label.show&&b();ctx.restore()}if(t){ctx=b;z=t.children().filter(".legend").children().width();o=Math.min(l.width,l.height/c.series.pie.tilt)/2;v=l.height/2+c.series.pie.offset.top;m=l.width/2;m="auto"==c.series.pie.offset.left?c.legend.position.match("w")?m+z/2:m-z/2:m+c.series.pie.offset.left;m<o?m=o:m>l.width-o&&(m=l.width-o);for(var d=a.getData(),h=0;w&&h<C;)w=!1,0<h&&(o*=I),h+=1,j(),0.8>=c.series.pie.tilt&&
g(),f();h>=C&&(j(),t.prepend('<div class="error">Could not draw pie with labels contained inside canvas</div>'));a.setSeries&&a.insertLegend&&(a.setSeries(d),a.insertLegend())}}function B(a){0<c.series.pie.innerRadius&&(a.save(),innerRadius=1<c.series.pie.innerRadius?c.series.pie.innerRadius:o*c.series.pie.innerRadius,a.globalCompositeOperation="destination-out",a.beginPath(),a.fillStyle=c.series.pie.stroke.color,a.arc(0,0,innerRadius,0,2*Math.PI,!1),a.fill(),a.closePath(),a.restore(),a.save(),a.beginPath(),
a.strokeStyle=c.series.pie.stroke.color,a.arc(0,0,innerRadius,0,2*Math.PI,!1),a.stroke(),a.closePath(),a.restore())}function J(a){D("plothover",a)}function K(a){D("plotclick",a)}function D(a,b){var j=r.offset(),g=parseInt(b.pageX-j.left);a:{for(var j=parseInt(b.pageY-j.top),f=r.getData(),d=r.getOptions(),d=1<d.series.pie.radius?d.series.pie.radius:o*d.series.pie.radius,h=0;h<f.length;++h){var e=f[h];if(e.pie.show){ctx.save();ctx.beginPath();ctx.moveTo(0,0);ctx.arc(0,0,d,e.startAngle,e.startAngle+
e.angle,!1);ctx.closePath();x=g-m;y=j-v;if(ctx.isPointInPath){if(ctx.isPointInPath(g-m,j-v)){ctx.restore();g={datapoint:[e.percent,e.data],dataIndex:0,series:e,seriesIndex:h};break a}}else{p1X=d*Math.cos(e.startAngle);p1Y=d*Math.sin(e.startAngle);p2X=d*Math.cos(e.startAngle+e.angle/4);p2Y=d*Math.sin(e.startAngle+e.angle/4);p3X=d*Math.cos(e.startAngle+e.angle/2);p3Y=d*Math.sin(e.startAngle+e.angle/2);p4X=d*Math.cos(e.startAngle+e.angle/1.5);p4Y=d*Math.sin(e.startAngle+e.angle/1.5);p5X=d*Math.cos(e.startAngle+
e.angle);p5Y=d*Math.sin(e.startAngle+e.angle);arrPoly=[[0,0],[p1X,p1Y],[p2X,p2Y],[p3X,p3Y],[p4X,p4Y],[p5X,p5Y]];arrPoint=[x,y];for(var l=!1,u=-1,s=arrPoly.length,n=s-1;++u<s;n=u)(arrPoly[u][1]<=arrPoint[1]&&arrPoint[1]<arrPoly[n][1]||arrPoly[n][1]<=arrPoint[1]&&arrPoint[1]<arrPoly[u][1])&&arrPoint[0]<(arrPoly[n][0]-arrPoly[u][0])*(arrPoint[1]-arrPoly[u][1])/(arrPoly[n][1]-arrPoly[u][1])+arrPoly[u][0]&&(l=!l);if(l){ctx.restore();g={datapoint:[e.percent,e.data],dataIndex:0,series:e,seriesIndex:h};break a}}ctx.restore()}}g=
null}if(c.grid.autoHighlight)for(j=0;j<k.length;++j)if(f=k[j],f.auto==a&&!(g&&f.series==g.series)&&(f=f.series,null==f&&(k=[],r.triggerRedrawOverlay()),"number"==typeof f&&(f=series[f]),f=E(f),-1!=f))k.splice(f,1),r.triggerRedrawOverlay();g&&(j=g.series,"number"==typeof j&&(j=series[j]),f=E(j),-1==f?(k.push({series:j,auto:a}),r.triggerRedrawOverlay()):a||(k[f].auto=!1));t.trigger(a,[{pageX:b.pageX,pageY:b.pageY},g])}function E(a){for(var b=0;b<k.length;++b)if(k[b].series==a)return b;return-1}function L(a,
b){var c=a.getOptions(),g=1<c.series.pie.radius?c.series.pie.radius:o*c.series.pie.radius;b.save();b.translate(m,v);b.scale(1,c.series.pie.tilt);for(i=0;i<k.length;++i){var f=k[i].series;0>=f.angle||isNaN(f.angle)||(b.fillStyle="rgba(255, 255, 255, "+c.series.pie.highlight.opacity+")",b.beginPath(),1.0E-9<Math.abs(f.angle-2*Math.PI)&&b.moveTo(0,0),b.arc(0,0,g,f.startAngle,f.startAngle+f.angle,!1),b.closePath(),b.fill())}B(b);b.restore()}var l=null,t=null,o=null,m=null,v=null,n=0,w=!0,C=10,I=0.95,
z=0,A=!1,k=[];r.hooks.processOptions.push(function(a,b){b.series.pie.show&&(b.grid.show=!1,"auto"==b.series.pie.label.show&&(b.series.pie.label.show=b.legend.show?!1:!0),"auto"==b.series.pie.radius&&(b.series.pie.radius=b.series.pie.label.show?0.75:1),1<b.series.pie.tilt&&(b.series.pie.tilt=1),0>b.series.pie.tilt&&(b.series.pie.tilt=0),a.hooks.processDatapoints.push(F),a.hooks.drawOverlay.push(L),a.hooks.draw.push(H))});r.hooks.bindEvents.push(function(a,b){var c=a.getOptions();c.series.pie.show&&
c.grid.hoverable&&b.unbind("mousemove").mousemove(J);c.series.pie.show&&c.grid.clickable&&b.unbind("click").click(K)})},options:c,name:"pie",version:"1.0"})})(jQuery);